<!DOCTYPE html>
<html>
<head>
    <title>MindSpace Chatbot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
    async function sendMessage() {
        const userMessage = document.getElementById("user_input").value;
        if (!userMessage.trim()) return;
        const response = await fetch('/get_response', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams({ message: userMessage })
        });
        const data = await response.json();
        
        const reply = data.reply.text;
        const context = data.reply.context;

        const chatLog = document.getElementById("chat_log");
        
        chatLog.innerHTML += `
            <div class="message user-message">
                <strong>You:</strong> ${userMessage}
            </div>
            <div class="message bot-message">
                <strong>MindSpace Bot:</strong> <span class="bot-reply">${reply}</span>
                <br><small class="bot-context">${context}</small>
            </div>
        `;
        chatLog.scrollTop = chatLog.scrollHeight; // scroll to bottom
        document.getElementById("user_input").value = "";
    }
    </script>
</head>
<body>
    <h2>MindSpace Chatbot</h2>
    <p>Your companion for gentle support and reflection</p>
    <div id="chat_log" class="chat-box"></div>
    <div class="chat-controls">
        <input id="user_input" placeholder="Type your feelings..." onkeydown="if(event.key==='Enter'){sendMessage()}">
        <button onclick="sendMessage()">Send</button>
    </div>
    <br><a href="/">Back to Home</a>
</body>
</html>
